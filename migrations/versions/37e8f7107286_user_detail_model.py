"""user_detail_model

Revision ID: 37e8f7107286
Revises: ee2597edabea
Create Date: 2024-11-26 13:32:41.297759

"""
from alembic import op
import sqlalchemy as sa
import sqlmodel             # NEW


# revision identifiers, used by Alembic.
revision = '37e8f7107286'
down_revision = 'ee2597edabea'
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('user_detail',
    sa.Column('user_detail_id', sa.Integer(), nullable=False),
    sa.Column('username', sqlmodel.sql.sqltypes.AutoString(length=100), nullable=False),
    sa.Column('user_email', sqlmodel.sql.sqltypes.AutoString(), nullable=False),
    sa.PrimaryKeyConstraint('user_detail_id'),
    schema='catalogdb'
    )
    op.add_column('app_user', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('app_user', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('bh_connection_config', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('bh_connection_config', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('bh_connection_registry', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('bh_connection_registry', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('bh_project', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('bh_project', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('bh_user', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('bh_user', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('configure_lifecycle', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('configure_lifecycle', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('connection_dtl', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('connection_dtl', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('customer', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('customer', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('data_source', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('data_source', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('data_source_layout', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('data_source_layout', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('data_source_metadata', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('data_source_metadata', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('fld_dq_types', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('fld_dq_types', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('fld_properties', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('fld_properties', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('fld_recommendations', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('fld_recommendations', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('flow', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('flow', sa.Column('recipient_email', sa.JSON(), nullable=True), schema='catalogdb')
    op.alter_column('flow', 'is_deleted',
               existing_type=sa.BOOLEAN(),
               nullable=True,
               schema='catalogdb')
    op.drop_column('flow', 'recipent_emails', schema='catalogdb')
    op.add_column('flow_config', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('flow_config', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.drop_constraint('flow_config_updated_by_fkey', 'flow_config', schema='catalogdb', type_='foreignkey')
    op.drop_constraint('flow_config_created_by_fkey', 'flow_config', schema='catalogdb', type_='foreignkey')
    op.add_column('flow_connection', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('flow_connection', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('flow_definition', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('flow_definition', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.drop_constraint('flow_definition_created_by_fkey', 'flow_definition', schema='catalogdb', type_='foreignkey')
    op.drop_constraint('flow_definition_updated_by_fkey', 'flow_definition', schema='catalogdb', type_='foreignkey')
    op.add_column('flow_deployment', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('flow_deployment', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('flow_version', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('flow_version', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.drop_constraint('flow_version_updated_by_fkey', 'flow_version', schema='catalogdb', type_='foreignkey')
    op.drop_constraint('flow_version_created_by_fkey', 'flow_version', schema='catalogdb', type_='foreignkey')
    op.add_column('function_registry', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('function_registry', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('join_on', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('join_on', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('joins', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('joins', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('lake_zone', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('lake_zone', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('layout_fields', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('layout_fields', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('layout_fields_dq', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('layout_fields_dq', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('pipeline', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('pipeline', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('pipeline_definitions', sa.Column('created_at', sa.DateTime(timezone=True), server_default=sa.text("(CURRENT_TIMESTAMP AT TIME ZONE 'UTC')"), nullable=True), schema='catalogdb')
    op.add_column('pipeline_definitions', sa.Column('updated_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('pipeline_definitions', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('pipeline_definitions', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('pre_configure_zone', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('pre_configure_zone', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('project_environment', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('project_environment', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('publish_details', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('publish_details', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('publish_query_details', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('publish_query_details', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('schema', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('schema', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.drop_constraint('schema_created_by_fkey', 'schema', schema='catalogdb', type_='foreignkey')
    op.drop_constraint('schema_updated_by_fkey', 'schema', schema='catalogdb', type_='foreignkey')
    op.add_column('transform_in_flds', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('transform_in_flds', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('transform_logic', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('transform_logic', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    op.add_column('transform_out_flds', sa.Column('deleted_by', sa.Integer(), nullable=True), schema='catalogdb')
    op.add_column('transform_out_flds', sa.Column('is_deleted', sa.Boolean(), nullable=True), schema='catalogdb')
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_column('transform_out_flds', 'is_deleted', schema='catalogdb')
    op.drop_column('transform_out_flds', 'deleted_by', schema='catalogdb')
    op.drop_column('transform_logic', 'is_deleted', schema='catalogdb')
    op.drop_column('transform_logic', 'deleted_by', schema='catalogdb')
    op.drop_column('transform_in_flds', 'is_deleted', schema='catalogdb')
    op.drop_column('transform_in_flds', 'deleted_by', schema='catalogdb')
    op.create_foreign_key('schema_updated_by_fkey', 'schema', 'bh_user', ['updated_by'], ['bh_user_id'], source_schema='catalogdb', referent_schema='catalogdb', ondelete='CASCADE')
    op.create_foreign_key('schema_created_by_fkey', 'schema', 'bh_user', ['created_by'], ['bh_user_id'], source_schema='catalogdb', referent_schema='catalogdb', ondelete='CASCADE')
    op.drop_column('schema', 'is_deleted', schema='catalogdb')
    op.drop_column('schema', 'deleted_by', schema='catalogdb')
    op.drop_column('publish_query_details', 'is_deleted', schema='catalogdb')
    op.drop_column('publish_query_details', 'deleted_by', schema='catalogdb')
    op.drop_column('publish_details', 'is_deleted', schema='catalogdb')
    op.drop_column('publish_details', 'deleted_by', schema='catalogdb')
    op.drop_column('project_environment', 'is_deleted', schema='catalogdb')
    op.drop_column('project_environment', 'deleted_by', schema='catalogdb')
    op.drop_column('pre_configure_zone', 'is_deleted', schema='catalogdb')
    op.drop_column('pre_configure_zone', 'deleted_by', schema='catalogdb')
    op.drop_column('pipeline_definitions', 'is_deleted', schema='catalogdb')
    op.drop_column('pipeline_definitions', 'deleted_by', schema='catalogdb')
    op.drop_column('pipeline_definitions', 'updated_by', schema='catalogdb')
    op.drop_column('pipeline_definitions', 'created_at', schema='catalogdb')
    op.drop_column('pipeline', 'is_deleted', schema='catalogdb')
    op.drop_column('pipeline', 'deleted_by', schema='catalogdb')
    op.drop_column('layout_fields_dq', 'is_deleted', schema='catalogdb')
    op.drop_column('layout_fields_dq', 'deleted_by', schema='catalogdb')
    op.drop_column('layout_fields', 'is_deleted', schema='catalogdb')
    op.drop_column('layout_fields', 'deleted_by', schema='catalogdb')
    op.drop_column('lake_zone', 'is_deleted', schema='catalogdb')
    op.drop_column('lake_zone', 'deleted_by', schema='catalogdb')
    op.drop_column('joins', 'is_deleted', schema='catalogdb')
    op.drop_column('joins', 'deleted_by', schema='catalogdb')
    op.drop_column('join_on', 'is_deleted', schema='catalogdb')
    op.drop_column('join_on', 'deleted_by', schema='catalogdb')
    op.drop_column('function_registry', 'is_deleted', schema='catalogdb')
    op.drop_column('function_registry', 'deleted_by', schema='catalogdb')
    op.create_foreign_key('flow_version_created_by_fkey', 'flow_version', 'bh_user', ['created_by'], ['bh_user_id'], source_schema='catalogdb', referent_schema='catalogdb', ondelete='CASCADE')
    op.create_foreign_key('flow_version_updated_by_fkey', 'flow_version', 'bh_user', ['updated_by'], ['bh_user_id'], source_schema='catalogdb', referent_schema='catalogdb', ondelete='CASCADE')
    op.drop_column('flow_version', 'is_deleted', schema='catalogdb')
    op.drop_column('flow_version', 'deleted_by', schema='catalogdb')
    op.drop_column('flow_deployment', 'is_deleted', schema='catalogdb')
    op.drop_column('flow_deployment', 'deleted_by', schema='catalogdb')
    op.create_foreign_key('flow_definition_updated_by_fkey', 'flow_definition', 'bh_user', ['updated_by'], ['bh_user_id'], source_schema='catalogdb', referent_schema='catalogdb', ondelete='CASCADE')
    op.create_foreign_key('flow_definition_created_by_fkey', 'flow_definition', 'bh_user', ['created_by'], ['bh_user_id'], source_schema='catalogdb', referent_schema='catalogdb', ondelete='CASCADE')
    op.drop_column('flow_definition', 'is_deleted', schema='catalogdb')
    op.drop_column('flow_definition', 'deleted_by', schema='catalogdb')
    op.drop_column('flow_connection', 'is_deleted', schema='catalogdb')
    op.drop_column('flow_connection', 'deleted_by', schema='catalogdb')
    op.create_foreign_key('flow_config_created_by_fkey', 'flow_config', 'bh_user', ['created_by'], ['bh_user_id'], source_schema='catalogdb', referent_schema='catalogdb', ondelete='CASCADE')
    op.create_foreign_key('flow_config_updated_by_fkey', 'flow_config', 'bh_user', ['updated_by'], ['bh_user_id'], source_schema='catalogdb', referent_schema='catalogdb', ondelete='CASCADE')
    op.drop_column('flow_config', 'is_deleted', schema='catalogdb')
    op.drop_column('flow_config', 'deleted_by', schema='catalogdb')
    op.add_column('flow', sa.Column('recipent_emails', sa.VARCHAR(), autoincrement=False, nullable=True), schema='catalogdb')
    op.alter_column('flow', 'is_deleted',
               existing_type=sa.BOOLEAN(),
               nullable=True,
               schema='catalogdb')
    op.drop_column('flow', 'recipient_email', schema='catalogdb')
    op.drop_column('flow', 'deleted_by', schema='catalogdb')
    op.drop_column('fld_recommendations', 'is_deleted', schema='catalogdb')
    op.drop_column('fld_recommendations', 'deleted_by', schema='catalogdb')
    op.drop_column('fld_properties', 'is_deleted', schema='catalogdb')
    op.drop_column('fld_properties', 'deleted_by', schema='catalogdb')
    op.drop_column('fld_dq_types', 'is_deleted', schema='catalogdb')
    op.drop_column('fld_dq_types', 'deleted_by', schema='catalogdb')
    op.drop_column('data_source_metadata', 'is_deleted', schema='catalogdb')
    op.drop_column('data_source_metadata', 'deleted_by', schema='catalogdb')
    op.drop_column('data_source_layout', 'is_deleted', schema='catalogdb')
    op.drop_column('data_source_layout', 'deleted_by', schema='catalogdb')
    op.drop_column('data_source', 'is_deleted', schema='catalogdb')
    op.drop_column('data_source', 'deleted_by', schema='catalogdb')
    op.drop_column('customer', 'is_deleted', schema='catalogdb')
    op.drop_column('customer', 'deleted_by', schema='catalogdb')
    op.drop_column('connection_dtl', 'is_deleted', schema='catalogdb')
    op.drop_column('connection_dtl', 'deleted_by', schema='catalogdb')
    op.drop_column('configure_lifecycle', 'is_deleted', schema='catalogdb')
    op.drop_column('configure_lifecycle', 'deleted_by', schema='catalogdb')
    op.drop_column('bh_user', 'is_deleted', schema='catalogdb')
    op.drop_column('bh_user', 'deleted_by', schema='catalogdb')
    op.drop_column('bh_project', 'is_deleted', schema='catalogdb')
    op.drop_column('bh_project', 'deleted_by', schema='catalogdb')
    op.drop_column('bh_connection_registry', 'is_deleted', schema='catalogdb')
    op.drop_column('bh_connection_registry', 'deleted_by', schema='catalogdb')
    op.drop_column('bh_connection_config', 'is_deleted', schema='catalogdb')
    op.drop_column('bh_connection_config', 'deleted_by', schema='catalogdb')
    op.drop_column('app_user', 'is_deleted', schema='catalogdb')
    op.drop_column('app_user', 'deleted_by', schema='catalogdb')
    op.drop_table('user_detail', schema='catalogdb')
    # ### end Alembic commands ###